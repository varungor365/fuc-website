{% comment %}
  Featured Product Section - Homepage Product Showcase
  Highlights a single product with full details and gallery
{% endcomment %}

{% schema %}
{
  "name": "Featured Product",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Featured Product"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {"value": "image-left", "label": "Image Left"},
        {"value": "image-right", "label": "Image Right"}
      ],
      "default": "image-left"
    }
  ],
  "presets": [
    {
      "name": "Featured Product"
    }
  ]
}
{% endschema %}

{% if section.settings.product %}
  {% assign product = section.settings.product %}
  
  <section class="featured-product-section">
    <div class="container featured-product-container">
      {% if section.settings.heading != blank %}
        <h2 class="section-heading">{{ section.settings.heading }}</h2>
      {% endif %}

      <div class="featured-product-wrapper featured-product-{{ section.settings.layout }}">
        <!-- Product Image -->
        <div class="featured-product-image">
          {% if product.featured_image %}
            <img
              src="{{ product.featured_image | image_url: width: 600 }}"
              alt="{{ product.featured_image.alt | default: product.title }}"
              class="featured-product-img"
              loading="lazy"
            >
          {% endif %}
        </div>

        <!-- Product Details -->
        <div class="featured-product-details">
          <h3 class="featured-product-title">{{ product.title }}</h3>

          <!-- Rating -->
          {% if product.metafields.reviews.rating %}
            <div class="featured-product-rating">
              <span class="stars">
                {% for i in (1..5) %}
                  {% if i <= product.metafields.reviews.rating %}
                    ★
                  {% else %}
                    ☆
                  {% endif %}
                {% endfor %}
              </span>
              <span class="rating-count">({{ product.reviews_count }} reviews)</span>
            </div>
          {% endif %}

          <!-- Price -->
          <div class="featured-product-price">
            {% if product.compare_at_price > product.price %}
              <span class="original-price">${{ product.compare_at_price | money }}</span>
              <span class="sale-price">${{ product.price | money }}</span>
              <span class="discount-badge">Save {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price | round }}%</span>
            {% else %}
              <span class="price">${{ product.price | money }}</span>
            {% endif %}
          </div>

          <!-- Description -->
          {% if product.description %}
            <div class="featured-product-description">
              {{ product.description | strip_html | truncatewords: 30 }}
            </div>
          {% endif %}

          <!-- Variants -->
          {% if product.variants.size > 1 %}
            <div class="featured-product-variants">
              {% for option in product.options_with_values %}
                <div class="variant-group">
                  <label>{{ option.name }}:</label>
                  <div class="variant-options">
                    {% for value in option.values %}
                      <button class="variant-option" data-value="{{ value }}">
                        {{ value }}
                      </button>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            </div>
          {% endif %}

          <!-- Add to Cart -->
          <form action="/cart/add" method="post" class="featured-product-form">
            <input type="hidden" name="id" value="{{ product.first_available_variant.id }}">
            <div class="quantity-wrapper">
              <label for="quantity">Quantity:</label>
              <input type="number" id="quantity" name="quantity" value="1" min="1">
            </div>
            <button type="submit" class="add-to-cart-btn" {{ product.available | unless: 'disabled' }}>
              {% if product.available %}
                Add to Cart
              {% else %}
                Sold Out
              {% endif %}
            </button>
          </form>

          <!-- Quick View -->
          <a href="{{ product.url }}" class="view-details-link">View Full Details →</a>
        </div>
      </div>
    </div>
  </section>
{% endif %}

<style>
  .featured-product-section {
    padding: 4rem 2rem;
  }

  .featured-product-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .section-heading {
    font-size: 2rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 3rem;
  }

  .featured-product-wrapper {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
  }

  .featured-product-image-right {
    grid-template-columns: 1fr 1fr;
  }

  .featured-product-image-right .featured-product-image {
    order: 2;
  }

  .featured-product-image-right .featured-product-details {
    order: 1;
  }

  .featured-product-img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 8px;
  }

  .featured-product-title {
    font-size: 2rem;
    font-weight: 700;
    margin: 0 0 1rem;
  }

  .featured-product-rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
  }

  .stars {
    color: #ffc107;
    font-size: 1.2rem;
  }

  .rating-count {
    color: #666;
  }

  .featured-product-price {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
  }

  .original-price {
    text-decoration: line-through;
    color: #999;
  }

  .sale-price {
    font-weight: 700;
    color: #dc3545;
  }

  .price {
    font-weight: 700;
  }

  .discount-badge {
    background: #dc3545;
    color: #fff;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.8rem;
  }

  .featured-product-description {
    font-size: 1rem;
    line-height: 1.6;
    color: #666;
    margin-bottom: 2rem;
  }

  .featured-product-variants {
    margin-bottom: 2rem;
  }

  .variant-group {
    margin-bottom: 1.5rem;
  }

  .variant-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .variant-options {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .variant-option {
    padding: 0.5rem 1rem;
    border: 2px solid #ccc;
    background: #fff;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .variant-option:hover {
    border-color: #000;
  }

  .variant-option.active {
    background: #000;
    color: #fff;
    border-color: #000;
  }

  .quantity-wrapper {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .quantity-wrapper input {
    width: 80px;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .add-to-cart-btn {
    width: 100%;
    padding: 1rem;
    background: #000;
    color: #fff;
    border: none;
    border-radius: 4px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
    margin-bottom: 1rem;
  }

  .add-to-cart-btn:hover:not(:disabled) {
    background: #333;
  }

  .add-to-cart-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
  }

  .view-details-link {
    display: inline-block;
    color: #000;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s;
  }

  .view-details-link:hover {
    color: #007aff;
  }

  @media (max-width: 768px) {
    .featured-product-wrapper {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .featured-product-image-right {
      grid-template-columns: 1fr;
    }

    .featured-product-image-right .featured-product-image {
      order: 0;
    }

    .featured-product-image-right .featured-product-details {
      order: 0;
    }

    .featured-product-title {
      font-size: 1.5rem;
    }

    .featured-product-section {
      padding: 2rem 1rem;
    }
  }
</style>
