<header class="page-header">
  <div class="container">    
    <h2>
      {% if collection.title != blank %}
      {% include 'multilang' with collection.title %}
      {% else %}
      <span {% if settings.enable_multilang %}data-translate="collections.general.items_count.other"{% endif %}>{{ 'collections.general.items_count.other' | t }}</span>
      {% endif %}
    </h2>
    
    {% include 'breadcrumb' %}
  </div>
</header>

<div class="col-main">
  <div itemscope itemtype="http://schema.org/Product" class="product container">
    <meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
    <meta itemprop="image" content="{{ product.featured_image.src | product_img_url: 'grande' }}">

    <div class="row">
      <div class="col-xs-12 col-sm-6">
        <div class="product-img-box {% if settings.product_image_border%}grid-item-border{% endif %}">
          {% if product.images.size == 0 %}
          <div class="product-photo-container">
            <img src="{{ '' | product_img_url: 'grande' }}" alt="">
          </div>
          {% else %}
          <div class="product-photo-container">
            {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
            <a href="{{ featured_image | img_url: 'original' }}" >
              <img id="product-featured-image" src="{{ featured_image | img_url: 'grande' }}" alt="{{ featured_image.alt | escape }}" data-zoom-image="{{ featured_image.src | img_url: 'original' }}"/>
            </a>
          </div>
          {% if product.images.size > 1 %}    
          <div class="more-view-wrapper {% if settings.style_moreview == 'vertical' %}more-view-wrapper-jcarousel{% else %} more-view-wrapper-owlslider {% endif %}">
            <ul id="more-view-carousel" class="product-photo-thumbs jcarousel-skin-tango">
              {% for image in product.images %}
              <li class="grid-item">
                <a href="javascript:void(0)" data-image="{{ image.src | product_img_url: 'grande' }}" data-zoom-image="{{ image.src | product_img_url: 'original' }}">
                  <img src="{{ image.src | product_img_url: 'small' }}" alt="{{ image.alt | escape }}">
                </a>
              </li>
              {% endfor %}
            </ul>
          </div>
          {% endif %}
          {% endif %}
        </div>
      </div>

      <div class="col-xs-12 col-sm-6 product-shop">
        <header class="product-title {% if collection.previous_product or collection.next_product and settings.display_prev_next_product and collection %}has-btn{% endif %}">
          <h2 itemprop="name">            
            {% include 'multilang' with product.title %}
          </h2>
          {% if settings.display_prev_next_product and collection %}
            {% if collection.previous_product %}
            <a class="prev btn" href="{{ collection.previous_product }}" {% if settings.enable_multilang %}data-translate="collections.toolbar.previous"{%endif%}>{{ 'collections.toolbar.previous' | t }}</a>
            {% endif %}
            {% if collection.next_product %}
            <a class="next btn" href="{{ collection.next_product }}" {% if settings.enable_multilang %}data-translate="collections.toolbar.next"{%endif%}>{{ 'collections.toolbar.next' | t }}</a>
            {% endif %}
          {% endif %}
        </header>

        {% if settings.display_sample_vendor %}
        <p class="sample-vendor"><span>{{ product.vendor }}</span></p>
        {% endif %}

        {% if settings.display_product_reviews %}       
        <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
        {% endif %}

        {% if settings.display_availability or settings.display_product_type or settings.display_vendor %}
        <div class="product-infor">
          {% if settings.display_availability %}
          <p class="product-inventory">
            {% if settings.text_availability != blank %}
            {% if settings.enable_multilang %}
            <label class="lang1">{{ settings.text_availability | split: '|' | first }}</label>
            <label class="lang2">{{ settings.text_availability | split: '|' | last }}</label>
            {% else %}
            <label>{{ settings.text_availability | split: '|' | first }}</label>
            {% endif %}
            {% endif %}
            <span>
            {% if product.selected_or_first_available_variant.inventory_management %}
            {% assign first_inventory = product.selected_or_first_available_variant.inventory_quantity %}
            {% if first_inventory > 0 %}
              {{first_inventory}} {{ 'products.product.in_stock' | t }}
            {% else %}
              {{ 'products.product.out_of_stock' | t }}
            {% endif %}
            {% else %}
              {{ 'products.product.many_in_stock' | t }}
            {% endif %}
            </span>
          </p>
          {% endif %}
          {% if settings.display_product_type %}
          <p class="product-type">
            {% if settings.text_product_type != blank %}
            {% if settings.enable_multilang %}
            <label class="lang1">{{ settings.text_product_type | split: '|' | first }}</label>
            <label class="lang2">{{ settings.text_product_type | split: '|' | last }}</label>
            {% else %}
            <label>{{ settings.text_product_type | split: '|' | first }}</label>              
            {% endif %}
            {% endif %}
            <span>{{ product.type }}</span>
          </p>
          {% endif %}
          {% if settings.display_vendor %}
          <p class="product-vendor">
            {% if settings.text_vendor != blank %}
            {% if settings.enable_multilang %}
            <label class="lang1">{{ settings.text_vendor | split: '|' | first }}</label>
            <label class="lang2">{{ settings.text_vendor | split: '|' | last }}</label>
            {% else %}
            <label>{{ settings.text_vendor | split: '|' | first }}</label>
            {% endif %}
            {% endif %}
            <span>{{ product.vendor }}</span>
          </p>
          {% endif %}
        </div>
        {% endif %}

        <div itemprop="offers" itemscope itemtype="http://schema.org/Offer">
          <meta itemprop="priceCurrency" content="{{ shop.currency }}">
          <link itemprop="availability" href="http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}">

          {% if product.description contains '[countdown]' %}
            {% assign des = product.description | split:'[/countdown]' | last %}
            {% if des contains '<p>[Custom Product Tab]</p>'%}
              {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
            {% endif %}
          {% else %}
            {% assign des = product.description %}
            {% if des contains '<p>[Custom Product Tab]</p>'%}
              {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
            {% endif %}
          {% endif %}

            {% if settings.show_desc == 'short' %}
            {% if settings.enable_multilang %}
            <div class="short-description lang1">{{ des | split: '[lang2]' | first | strip_html | truncatewords: 50 }}</div>
            <div class="short-description lang2">{{ des | split: '[lang2]' | last | strip_html | truncatewords: 50 }}</div>
            {% else %}
            <div class="short-description">{{ des | split: '[lang2]' | first | strip_html | truncatewords: 50 }}</div>
            {% endif %}
            {% elsif settings.show_desc == 'full' %}
            {% if settings.enable_multilang %}
            <div class="short-description lang1">{{ des | split: '[lang2]' | first }}</div>                
            <div class="short-description lang2">{{ des | split: '[lang2]' | last }}</div>
            {% else %}
            <div class="short-description">{{ des | split: '[lang2]' | first }}</div>                
            {% endif %}
            {% endif %}

          {% if product.description contains '[countdown]' %}            
          {% assign count_down_first = product.description | split:'[/countdown]' | first %}
          {% assign count_down_final = count_down_first | split:'[countdown]' | last %}
          <div class="countdown text-center">
            <span>
              {% include 'multilang' with settings.text_countdown %}
            </span>
            <div id="clock" class="time"></div>
          </div>
          <script>
            $(document ).ready(function() {
              $("#clock").countdown('{{ count_down_final }}', function(event) {
                $(this).html(event.strftime(''+ 
                                            '<div><span>%D</span> days</div>'+ 
                                            '<div><span>%H</span> hours</div>'+ 
                                            '<div><span>%M</span> mins</div>'+ 
                                            '<div><span>%S</span> secs</div>'
                                           ));
              });
            })
          </script>
          {% endif %}

          <form action="/cart/add" method="post" enctype="multipart/form-data" id="add-to-cart-form">
            <div class="prices">
              {% if product.compare_at_price > product.price %}
              <span class="compare-price">{{ product.compare_at_price_max | money }}</span>
              <span class="price on-sale" itemprop="price">{{ product.price | money }}</span>
              <div class="price-saving">
                <span {% if settings.enable_multilang %}data-translate="products.product.save"{% endif %}>{{'products.product.save' | t }}</span>
                <span class="price-save">{{ product.compare_at_price | minus: product.price | money }}</span>
              </div>
              
              {% else %}
              <span class="price" itemprop="price">{{ product.price | money }}</span>
              {% endif %}
            </div>

            <div id="product-variants">
              {% assign variantCount = product.variants | size %}
              {% if product.available %} 
              {% if variantCount > 1 %} 
              <select id="product-selectors" name="id" style="display:none">
                {% for variant in product.variants %}
                <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
                {% endfor %}
              </select>

              {% if settings.use_color_swatch %}
              {% for option in product.options %}
              {% include 'swatch' with option %}
              {% endfor %}
              {% endif %}
              {% else %}
              <input type="hidden" name="id" value="{{ product.variants[0].id }}" />
              {% endif %}
              {% endif %}
            </div>

            {% if product.available %} 
            <label for="quantity" {% if settings.enable_multilang %}data-translate="cart.label.quantity"{%endif%}>{{ 'cart.label.quantity' | t }}: </label>

            <input type="text" id="quantity" name="quantity" value="1">
            <div class="extra">
              <div class="inc button">+</div>
              <div class="dec button">-</div>
            </div>
            <script>
              jQuery(".button").on("click", function() {
                var oldValue = jQuery("#quantity").val(),
                    newVal = 1;

                if (jQuery(this).text() == "+") {
                    newVal = parseInt(oldValue) + 1;
                  } else if (oldValue > 1) {
                    newVal = parseInt(oldValue) - 1;
                }

                jQuery("#quantity").val(newVal);
                {% if settings.display_subtotal and product.available %} 
                updatePricing();
                {% endif %}
              });
            </script>

            {% if settings.display_subtotal and product.available %} 
            <div class="total-price">
              <label>
                <strong {% if settings.enable_multilang %}data-translate="cart.general.subtotal"{%endif%}>
                  {{ 'cart.general.subtotal' | t }}
                </strong>
                :</label><span>{{ product.price | money }}</span>
            </div>
            {% endif %}

            <input type="submit" name="add" class="btn" {% if settings.enable_multilang %}data-translate="products.product.add_to_cart"{%endif%} id="product-add-to-cart" value="{{ 'products.product.add_to_cart' | t }}">
            {% else %} 
            <input type="submit" name="add" class="btn" {% if settings.enable_multilang %}data-translate="products.product.unavailable"{%endif%} id="product-add-to-cart" disabled value="{{ 'products.product.unavailable' | t }}">          
            {% endif %}
          </form>            
        </div>

        {% include 'wishlist-product' %}
        {% unless customer %}
          <p class="text-register">
            <span {% if settings.enable_multilang %}data-translate="wishlist.general.subtext_product"{% endif %}>{{ 'wishlist.general.subtext_product' | t }}</span>
            <a href="/account/login" {% if settings.enable_multilang %}data-translate="wishlist.general.sign_in"{% endif %}>{{ 'wishlist.general.sign_in' | t }}</a>
            <span {% if settings.enable_multilang %}data-translate="wishlist.general.or"{% endif %}>{{ 'wishlist.general.or' | t }}</span>
            <a href="/account/register" {% if settings.enable_multilang %}data-translate="wishlist.general.create_account"{% endif %}>{{ 'wishlist.general.create_account' | t }}</a>
          </p>
        {% endunless %}

        {% if settings.display_share %}
          {% include 'share' with product %}
        {% endif %}

        {% if settings.show_tab == 'vertical' %}
        <div class="panel-group" id="accordion">
          {% if settings.display_product_detail_description %}
          <div class="panel product-description rte wow fadeInUp">
            <div class="panel-heading">
              <h6 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse-tab1">                  
                  {% include 'multilang' with settings.product_description_title %}
                </a>
              </h6>
            </div>
            <div id="collapse-tab1" class="panel-collapse collapse">
              <div class="panel-body" itemprop="description">

                {% if product.description contains '[countdown]' %}
                  {% assign des = product.description | split:'[/countdown]</p>' | last %}

                  {% if des contains '<p>[Custom Product Tab]</p>'%}
                    {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
                  {% endif %}
                {% else %}
                  {% assign des = product.description %}

                  {% if des contains '<p>[Custom Product Tab]</p>'%}
                    {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
                  {% endif %}
                {% endif %}

                {% if settings.enable_multilang %}
                <div class="lang1">{{ des | split: '[lang2]' | first }}</div>
                <div class="lang2">{{ des | split: '[lang2]' | last }}</div>
                {% else %}
                <div>{{ des | split: '[lang2]' | first }}</div>
                {% endif %}

              </div>
            </div>
          </div>
          {% endif %}

          {% if settings.display_custom_tab %}
          <div class="panel wow fadeInUp" data-wow-delay="100ms">
            <div class="panel-heading">
              <h6 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse-tab2">                  
                  {% include 'multilang' with settings.custom_tab_title %}
                </a>
              </h6>
            </div>
            <div id="collapse-tab2" class="panel-collapse collapse">
              {% if settings.enable_multilang %}
              <div class="panel-body lang1">{{ settings.custom_tab_content | split: '[lang2]' | first }}</div>
              <div class="panel-body lang2">{{ settings.custom_tab_content | split: '[lang2]' | last }}</div>
              {% else %}
              <div class="panel-body">{{ settings.custom_tab_content | split: '[lang2]' | first }}</div>
              {% endif %}
            </div>
          </div>
          {% endif %}

          {% if settings.display_custom_tab_02 and product.description contains '<p>[Custom Product Tab]</p>'%}
          <div class="panel wow fadeInUp" data-wow-delay="200ms">
            <div class="panel-heading">
              <h6 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse-tab3">                  
                  {% include 'multilang' with settings.custom_tab_title_02 %}
                </a>
              </h6>
            </div>
            <div id="collapse-tab3" class="panel-collapse collapse">
              <div class="panel-body">
                {% if product.description contains '<p>[Custom Product Tab]</p>' %}
                  {% assign des = product.description | split:'<p>[Custom Product Tab]</p>' | last | split:'<p>[/Custom Product Tab]</p>' | first %}
                  {% if settings.enable_multilang %}
                  <div class="lang1">{{ des | split: '[lang2]' | first }}</div>
                  <div class="lang2">{{ des | split: '[lang2]' | last }}</div>
                  {% else %}
                  <div>{{ des | split: '[lang2]' | first }}</div>
                  {% endif %}
                {% endif %}
              </div>
            </div>
          </div>
          {% endif %}

          {% if settings.display_product_reviews %}
          <div class="panel wow fadeInUp" data-wow-delay="300ms">
            <div class="panel-heading">
              <h6 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse-tab4">                  
                  {% include 'multilang' with settings.product_review_title %}
                </a>
              </h6>
            </div>
            <div id="collapse-tab4" class="panel-collapse collapse">
              <div class="panel-body">
                <div id="shopify-product-reviews" data-id="{{product.id}}">{{ product.metafields.spr.reviews }}</div>
              </div>
            </div>
          </div>
          {% endif %}
        </div>            
        {% endif %}

      </div>
    </div>
  </div>

  {% if settings.show_tab == 'horizontal' %}
  <div class="panel-group">
    <ul class="nav nav-tabs container" id="myTab">
      {% if settings.display_product_detail_description %}
      <li class="active">
        <a data-toggle="tab" href="#collapse-tab1">          
          {% include 'multilang' with settings.product_description_title %}
        </a>
      </li>
      {% endif %}

      {% if settings.display_product_reviews %}       
      <li class="product-review">
        <a data-toggle="tab" href="#collapse-tab2">          
          {% include 'multilang' with settings.product_review_title %}
        </a>
      </li>
      {% endif %}

      {% if settings.display_custom_tab %}
      <li>
        <a data-toggle="tab" href="#collapse-tab3">          
          {% include 'multilang' with settings.custom_tab_title %}
        </a>
      </li>
      {% endif %}

      {% if settings.display_custom_tab_02 and product.description contains '<p>[Custom Product Tab]</p>' %}
      <li>
        <a data-toggle="tab" href="#collapse-tab4">          
          {% include 'multilang' with settings.custom_tab_title_02 %}
        </a>
      </li>
      {% endif %}
    </ul>

    <div class="inner">      
      <div id="myTabContent" class="tab-content container">
        {% if settings.display_product_detail_description %}

          {% if product.description contains '[countdown]' %}
            {% assign des = product.description | split:'[/countdown]</p>' | last %}

            {% if des contains '<p>[Custom Product Tab]</p>'%}
              {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
            {% endif %}
          {% else %}
            {% assign des = product.description %}

            {% if des contains '<p>[Custom Product Tab]</p>'%}
              {% assign des = des | split:'<p>[Custom Product Tab]</p>' | first %}
            {% endif %}
          {% endif %}

            <div id="collapse-tab1" class="tab-pane fade in active">
              {% if settings.enable_multilang %}
              <div class="lang1">{{ des | split: '[lang2]' | first }}</div>
              <div class="lang2">{{ des | split: '[lang2]' | last }}</div>
              {% else %}
              <div>{{ des | split: '[lang2]' | first }}</div>
              {% endif %}
            </div>            
        {% endif %}

        {% if settings.display_product_reviews %}       
        <div id="collapse-tab2" class="tab-pane fade">
          <div id="shopify-product-reviews" data-id="{{product.id}}">{{ product.metafields.spr.reviews }}</div>
        </div>
        {% endif %}

        {% if settings.display_custom_tab %}
        <div id="collapse-tab3" class="tab-pane fade">
          {% if settings.enable_multilang %}
          <div class="lang1">{{ settings.custom_tab_content | split: '[lang2]' | first }}</div>
          <div class="lang2">{{ settings.custom_tab_content | split: '[lang2]' | last }}</div>
          {% else %}
          <div>{{ settings.custom_tab_content | split: '[lang2]' | first }}</div>
          {% endif %}
        </div>
        {% endif %}

        {% if settings.display_custom_tab_02 and product.description contains '<p>[Custom Product Tab]</p>' %}
        <div id="collapse-tab4" class="tab-pane fade">
          {% if product.description contains '<p>[Custom Product Tab]</p>' %}
            {% assign des = product.description | split:'<p>[Custom Product Tab]</p>' | last | split:'<p>[/Custom Product Tab]</p>' | first %}
            {% if settings.enable_multilang %}
            <div class="lang1">{{ des | split: '[lang2]' | first }}</div>
            <div class="lang2">{{ des | split: '[lang2]' | last }}</div>
            {% else %}
            <div>{{ des | split: '[lang2]' | first }}</div>
            {% endif %}
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  {% if settings.display_related_products %} 
  {% if settings.related_products_type == "tags" %}
  {% include 'related-products-by-tags' %}
  {% else %}
  {% include 'related-products' %}
  {% endif %}
  {% endif %}

  {{ 'option_selection.js' | shopify_asset_url | script_tag }}

</div>

{% if settings.display_recently_viewed_products %} 
{% include 'recently-viewed-products' %}
{% endif %}

<script>
  //Shopify.Image.preload({{ product.images | json }}, 'grande');

  {% if settings.display_subtotal and product.available %} 
  //update price when changing quantity
  function updatePricing() {
    //try pattern one before pattern 2
    var regex = /([0-9]+[.|,][0-9]+[.|,][0-9]+)/g;
    var unitPriceTextMatch = jQuery('.product .price').text().match(regex);
   
    if (!unitPriceTextMatch) {
      regex = /([0-9]+[.|,][0-9]+)/g;
      unitPriceTextMatch = jQuery('.product .price').text().match(regex);     
    }
   
    if (unitPriceTextMatch) {
      var unitPriceText = unitPriceTextMatch[0];     
      var unitPrice = unitPriceText.replace(/[.|,]/g,'');
      var quantity = parseInt(jQuery('#quantity').val());
      var totalPrice = unitPrice * quantity;

      var totalPriceText = Shopify.formatMoney(totalPrice, window.money_format);
      regex = /([0-9]+[.|,][0-9]+[.|,][0-9]+)/g;     
      if (!totalPriceText.match(regex)) {
        regex = /([0-9]+[.|,][0-9]+)/g;
      } 
      totalPriceText = totalPriceText.match(regex)[0];

      var regInput = new RegExp(unitPriceText, "g"); 
      var totalPriceHtml = jQuery('.product .price').html().replace(regInput ,totalPriceText);

      jQuery('.product .total-price span').html(totalPriceHtml);     
    }
  }

  jQuery('#quantity').on('change', updatePricing);
  {% endif %}
  
var selectCallback = function(variant, selector) {

  var addToCart = jQuery('#product-add-to-cart'),
      productPrice = jQuery('.product .price'),
      comparePrice = jQuery('.product .compare-price'),
      priceSaving = jQuery('.product .price-saving .price-save');
  
  if (variant) {
    if (variant.available) {
      // We have a valid product variant, so enable the submit button
      addToCart.removeClass('disabled').removeAttr('disabled').val(window.inventory_text.add_to_cart);

    } else {
      // Variant is sold out, disable the submit button
      addToCart.val(window.inventory_text.sold_out).addClass('disabled').attr('disabled', 'disabled');
    }

    // Regardless of stock, update the product price
    productPrice.html(Shopify.formatMoney(variant.price, "{{ shop.money_format }}"));

    // Also update and show the product's compare price if necessary
    if ( variant.compare_at_price > variant.price ) {
      priceSaving
        .html(Shopify.formatMoney(variant.compare_at_price - variant.price, "{{ shop.money_format }}"));
      jQuery('.product .price-saving').show();
      productPrice.addClass("on-sale");
      comparePrice
        .html(Shopify.formatMoney(variant.compare_at_price, "{{ shop.money_format }}"))
        .show();
    } else {
      comparePrice.hide();
      jQuery('.product .price-saving').hide();
      productPrice.removeClass("on-sale");
    }
    {% if settings.use_color_swatch %}
    // BEGIN SWATCHES
      var form = jQuery('#' + selector.domIdPrefix).closest('form');
      for (var i=0,length=variant.options.length; i<length; i++) {
        var radioButton = form.find('.swatch[data-option-index="' + i + '"] :radio[value="' + variant.options[i] +'"]');
        if (radioButton.size()) {
          radioButton.get(0).checked = true;
        }
      }
    // END SWATCHES
    {% endif %}
  
    {% if settings.display_subtotal and product.available %}  
    updatePricing();
    {% endif %}
  
    {% if settings.enable_multiple_currencies %}
    Currency.convertAll('{{ shop.currency }}', jQuery('#currencies').val(), 'span.money', 'money_format');
    {% endif %}
          
  } else {
    // The variant doesn't exist. Just a safeguard for errors, but disable the submit button anyway
    addToCart.val(window.inventory_text.unavailable).addClass('disabled').attr('disabled', 'disabled');
  }

  //update variant inventory
  {% if settings.display_availability %}
  if (variant.available) {
    if (variant.inventory_management!=null) {
      jQuery(".product-inventory span").text(variant.inventory_quantity + " " + window.inventory_text.out_of_stock.in_stock);
    } else {
      jQuery(".product-inventory span").text(window.inventory_text.many_in_stock);
    }
  } else {
    jQuery(".product-inventory span").text(window.inventory_text.out_of_stock);
  }
  {% endif %}
                                           
  /*begin variant image*/
  if (variant && variant.featured_image) {
      var originalImage = jQuery("#product-featured-image");
      var newImage = variant.featured_image;
      var element = originalImage[0];
      Shopify.Image.switchImage(newImage, element, function (newImageSizedSrc, newImage, element) {
        jQuery('#more-view-carousel img').each(function() {
          var grandSize = jQuery(this).attr('src');
          grandSize = grandSize.replace('small','grande');
          if (grandSize == newImageSizedSrc) {
            jQuery(this).parent().trigger('click');              
            return false;
          }
        });
      });        
  }
  /*end of variant image*/
};

jQuery(function($) {
  {% if product.available and product.variants.size > 1 %}
    new Shopify.OptionSelectors('product-selectors', {
      product: {{ product | json }},
      onVariantSelected: selectCallback, 
    enableHistoryState: true
    });   
     
     {% comment %}
     Use color swatch and linked options (copyright by @carolineschnapp)
     {% endcomment %}
     {% if settings.use_color_swatch and product.available and product.options.size > 1 %}
     Shopify.linkOptionSelectors({{ product | json }});
     {% endif %} 
     
     {% if settings.use_color_swatch != true %}
      jQuery('.single-option-selector').selectize();
      jQuery('.selectize-input input').attr("disabled","disabled");
     {% endif %}

   {% endif %}
  
  // Add label if only one product option and it isn't 'Title'. Could be 'Size'.
  {% if product.options.size == 1 and product.options.first != 'Title' %}
    $('.selector-wrapper:eq(0)').prepend('<label>{{ product.options.first }}</label>');
  {% endif %}

  // Hide selectors if we only have 1 variant and its title contains 'Default'.
  {% if product.variants.size == 1 and product.variants.first.title contains 'Default' %}
    $('.selector-wrapper').hide();
  {% endif %}

  // Auto-select first available variant on page load. Otherwise the product looks sold out.
  {% assign found_one_in_stock = false %}
  {% for variant in product.variants %}
    {% if variant.available and found_one_in_stock == false %}
      {% assign found_one_in_stock = true %}
      {% for option in product.options %}
      $('.single-option-selector:eq({{ forloop.index0 }})').val({{ variant.options[forloop.index0] | json }}).trigger('change');
      {% endfor %}
    {% endif %}
  {% endfor %}
  
  {% if settings.display_product_reviews %}
    var reviewsTimeout = setInterval(function() {
    if (jQuery('.spr-badge-caption').length>0) {
      jQuery('.spr-badge-caption').on('click', function() {
          jQuery('html,body').animate({
            {% if settings.show_tab == 'vertical' %}
            scrollTop: jQuery('.panel:last').offset().top},
            {% else %}
            scrollTop: jQuery('.nav-tabs li:last').offset().top},
            {% endif %}
              '400');
          {% if settings.show_tab == 'vertical' %}
          jQuery('#collapse-tab2').collapse('show');
          {% else %}
          jQuery('.nav-tabs li').removeClass('active');
          jQuery('.nav-tabs li.product-review').addClass('active');
          jQuery('.tab-pane').removeClass('active in');
          jQuery('#collapse-tab2').addClass('active in');
          {% endif %}
        });
        clearInterval(reviewsTimeout);
      }
    },1000);    
  {% endif %} 
});
</script>